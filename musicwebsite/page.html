<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Music WebSite</title>
    <script type="text/javascript" src="fonctions.js"></script>
</head>
<script>
    if(!sessionStorage.getItem('active_token')) {
        getToken(function (token) {
            console.log(token["access_token"])
            sessionStorage.setItem("active_token", token["access_token"]);
            window.location.reload();
        });

    }
    else {
        const data = null;

        const xhr = new XMLHttpRequest();
        xhr.withCredentials = true;

        xhr.addEventListener("readystatechange", function () {
            if (this.readyState === this.DONE) {
                var mesartistes = JSON.parse(xhr.responseText);
                mesartistes['items'].forEach(element => {
                    document.getElementById('NameArtist').innerHTML += element['name'] + "<br>";
                });
            }
        });

        xhr.open("GET", "https://api.spotify.com/v1/me/top/artists?time_range=long_term&limit=10&offset=0");
        xhr.setRequestHeader("authorization", "Bearer " + sessionStorage.getItem('active_token'));

        xhr.send(data);
    }

</script>
<body>
<div id="Artist"></div>

<p id="NameArtist" name="cboNameArtist"></p>



</body>
</html>